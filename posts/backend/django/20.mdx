---
title: "[Django] REST API"

categories:
  - Django

tags:
  - Django

date: 2022-04-20T18:00
last_modified_at: 2022-04-20T18:00
author_profile: true

toc: true
toc_label: "ëª©ì°¨"
toc_icon: "bars"
toc_sticky: true
published: true
---

## HTTP

- HyperText Transfer Protocol
- ì›¹ ìƒì—ì„œ ì»¨í…ì¸ ë¥¼ ì „ì†¡í•˜ê¸° ìœ„í•œ ì•½ì†
- HTML ë¬¸ì„œì™€ ê°™ì€ ë¦¬ì†ŒìŠ¤ë“¤ì„ ê°€ì ¸ì˜¬ ìˆ˜ ìˆë„ë¡ í•˜ëŠ” í”„ë¡œí† ì½œ(ê·œì¹™, ì•½ì†)

<br />

- Stateless
- Connectionless

- ì¿ í‚¤ì™€ ì„¸ì…˜ì„ í†µí•´ ì„œë²„ ìƒíƒœë¥¼ ìš”ì²­ê³¼ ì—°ê²°í•˜ë„ë¡ í•¨

<br />

### HTTP request methods

- ìì›ì— ëŒ€í•œ í–‰ìœ„(ìˆ˜í–‰í•˜ê³ ì í•˜ëŠ” ë™ì‘)ë¥¼ ì •ì˜
- ì£¼ì–´ì§„ ë¦¬ì†ŒìŠ¤(ìì›)ì— ìˆ˜í–‰í•˜ê¸¸ ì›í•˜ëŠ” í–‰ë™ì„ ë‚˜íƒ€ëƒ„
- GET, POST, PUT, DELETE

<br />

### HTTP response status codes

- íŠ¹ì • HTTP ìš”ì²­ì´ ì„±ê³µì ìœ¼ë¡œ ì™„ë£Œë˜ì—ˆëŠ”ì§€ ì—¬ë¶€

1. (1xx) Informational responses
2. (2xx) Successful responses
3. (3xx) Redirection responses
4. (4xx) Client error responses
5. (5xx) Server error responses

<br />

### ì›¹ì—ì„œì˜ ë¦¬ì†ŒìŠ¤ ì‹ë³„

- ë¦¬ì†ŒìŠ¤(ìì›) : HTTP ìš”ì²­ì˜ ëŒ€ìƒ
- ë¬¸ì„œ, ì‚¬ì§„ ë“± ì–´ë–¤ ê²ƒì´ë“  ë  ìˆ˜ ìˆë‹¤.
- ê° ë¦¬ì†ŒìŠ¤ëŠ” ë¦¬ì†ŒìŠ¤ ì‹ë³„ì„ ìœ„í•´ HTTP ì „ì²´ì—ì„œ ì‚¬ìš©ë˜ëŠ” **URI(Uniform Resource Identifier)**ë¡œ ì‹ë³„

<br />

### URL, URN, URI

> URL(Uniform Resource Locator)

- í†µí•© ìì› ìœ„ì¹˜
- ë„¤íŠ¸ì›Œí¬ ìƒì— ìì›ì´ ì–´ë”” ìˆëŠ”ì§€ ì•Œë ¤ì£¼ê¸° ìœ„í•œ ì•½ì†
- ê³¼ê±°ì—ëŠ” ì‹¤ì œ ìì› ìœ„ì¹˜ë¥¼ í‘œì‹œ, í˜„ì¬ëŠ” ì¶”ìƒí™”ëœ ì˜ë¯¸ë¡ ì  êµ¬ì„±
- 'ì›¹ ì£¼ì†Œ', 'ë§í¬' ë“±ìœ¼ë¡œ ë¶ˆë¦¼

<br />

> URN(Uniform Resource Name)

- í†µí•© ìì› ì´ë¦„
- URLê³¼ ë‹¬ë¦¬ **ìì›ì˜ ìœ„ì¹˜ì— ì˜í–¥ì„ ë°›ì§€ ì•ŠëŠ” ìœ ì¼í•œ ì´ë¦„** ì—­í• 
- ex. ISBN(êµ­ì œí‘œì¤€ë„ì„œë²ˆí˜¸)

<br />

> URI(Uniform Resource Identifier)

- í†µí•© ìì› ì‹ë³„ì
- ì¸í„°ë„·ì˜ ìì›ì„ ì‹ë³„í•˜ëŠ” ìœ ì¼í•œ ì£¼ì†Œ
- ì¸í„°ë„·ì—ì„œ ìì›ì„ ì‹ë³„í•˜ê±°ë‚˜ ì´ë¦„ì„ ì§€ì •í•˜ëŠ” ë°ì— ì‚¬ìš©ë˜ëŠ” ê°„ë‹¨í•œ ë¬¸ìì—´
- URL, URNì˜ í° ë²”ìœ„
- URNì„ ì‚¬ìš©í•˜ëŠ” ë¹„ì¤‘ì´ ì ì–´, ì¼ë°˜ì ìœ¼ë¡œ URLì€ URIì™€ ê°™ì€ ì˜ë¯¸ë¡œ ì‚¬ìš©

<br />

### URIì˜ êµ¬ì¡°

> ì˜ˆì‹œ URI : https://www.example.com:80/path/to/myfile.html/?key=value#quick-start

> Scheme : **https://**

- ë¸Œë¼ìš°ì €ê°€ ì‚¬ìš©í•´ì•¼ í•˜ëŠ” í”„ë¡œí† ì½œ
- http(s), data, file, ftp, mailto

<br />

> Host(Domain name) : **www.example.com**

- ìš”ì²­ì„ ë°›ëŠ” ì›¹ ì„œë²„ì˜ ì´ë¦„
- IP addressë¥¼ ì§ì ‘ ì‚¬ìš©í•  ìˆ˜ ìˆìœ¼ë‚˜, ì‹¤ ì‚¬ìš©ì‹œ ë¶ˆí¸í•˜ì—¬ ì›¹ì—ì„œëŠ” ì§€ì–‘

<br />

> Port : **:80**

- ì›¹ ì„œë²„ ìƒì˜ ë¦¬ì†ŒìŠ¤ì— ì ‘ê·¼í•˜ëŠ”ë° ì‚¬ìš©ë˜ëŠ” ê¸°ìˆ ì ì¸ 'ë¬¸(gate)'
- HTTP í”„ë¡œí† ì½œì˜ í‘œì¤€ í¬íŠ¸
  - HTTP 80
  - HTTPS 443

<br />

> Path : **/path/to/myfile.html**

- ì›¹ ì„œë²„ ìƒì˜ ë¦¬ì†ŒìŠ¤ ê²½ë¡œ
- ì´ˆê¸°ì—ëŠ” ì‹¤ì œ íŒŒì¼ì´ ìœ„ì¹˜í•œ ë¬¼ë¦¬ì  ìœ„ì¹˜
- ì˜¤ëŠ˜ë‚ ì€ ë¬¼ë¦¬ì  ì‹¤ì œ ìœ„ì¹˜ê°€ ì•„ë‹Œ ì¶”ìƒì  êµ¬ì¡°ë¡œ í‘œí˜„

<br />

> Query(Identifier) : **?key=value**

- Query String Parameter
- ì›¹ ì„œë²„ì— ì œê³µë˜ëŠ” ì¶”ê°€ì ì¸ ë§¤ê°œ ë³€ìˆ˜
- & ë¡œ êµ¬ë¶„ë˜ëŠ” key-value ëª©ë¡

<br />

> Fragment : **#quick-start**

- Anchor
- ìì› ì•ˆì—ì„œì˜ ë¶ë§ˆí¬ì˜ í•œ ì¢…ë¥˜
- ë¸Œë¼ìš°ì €ì—ê²Œ í•´ë‹¹ ë¬¸ì„œ(HTML)ì˜ íŠ¹ì • ë¶€ë¶„ì„ ë³´ì—¬ì£¼ê¸° ìœ„í•œ ë°©ë²•
- fragment identifier(ë¶€ë¶„ ì‹ë³„ì)ë¼ê³  ë¶€ë¥¸ë‹¤.
- **# ë’¤ì˜ ë¶€ë¶„ì€ ìš”ì²­ì´ ì„œë²„ì— ë³´ë‚´ì§€ì§€ ì•ŠëŠ”ë‹¤.**

<br />

## RESTful API

### API

- Application Programming Interface
- í”„ë¡œê·¸ë˜ë° ì–¸ì–´ê°€ ì œê³µí•˜ëŠ” ê¸°ëŠ¥ì„ ìˆ˜í–‰í•  ìˆ˜ ìˆê²Œ ë§Œë“  ì¸í„°í˜ì´ìŠ¤
- ì–´í”Œë¦¬ì¼€ì´ì…˜ê³¼ í”„ë¡œê·¸ë˜ë°ìœ¼ë¡œ ì†Œí†µí•˜ëŠ” ë°©ë²•

<br />

> Web API

- ì›¹ ì• í”Œë¦¬ì¼€ì´ì…˜ ê°œë°œì—ì„œ ë‹¤ë¥¸ ì„œë¹„ìŠ¤ì— ìš”ì²­ì„ ë³´ë‚´ê³  ì‘ë‹µì„ ë°›ê¸° ìœ„í•´ ì •ì˜ëœ ëª…ì„¸
- í˜„ì¬ ì›¹ ê°œë°œì€ ì—¬ëŸ¬ Open APIë¥¼ í™œìš©

<br />

### REST

- REpresentational State Transfer
- API Serverë¥¼ ê°œë°œí•˜ê¸° ìœ„í•œ ì¼ì¢…ì˜ ì†Œí”„íŠ¸ì›¨ì–´ ì„¤ê³„ ë°©ë²•ë¡ 
  - 2000ë…„ ë¡œì´ í•„ë”©ì˜ ë°•ì‚¬í•™ìœ„ ë…¼ë¬¸ì—ì„œ ì²˜ìŒìœ¼ë¡œ ì†Œê°œëœ í›„ ë„¤íŠ¸ì›Œí‚¹ ë¬¸í™”ì— ë„ë¦¬ í¼ì§
- ë„¤íŠ¸ì›Œí¬ êµ¬ì¡°(Network Architecture) ì›ë¦¬ì˜ ëª¨ìŒ
  - ìì›ì„ ì •ì˜í•˜ê³  ìì›ì— ëŒ€í•œ ì£¼ì†Œë¥¼ ì§€ì •í•˜ëŠ” ì „ë°˜ì  ë°©ë²•
- REST ì›ë¦¬ë¥¼ ë”°ë¥´ëŠ” ì‹œìŠ¤í…œì„ **RESTfulì´ë€ ìš©ì–´ë¡œ ì§€ì¹­**

<br />

> RESTì˜ ìì›ê³¼ ì£¼ì†Œì˜ ì§€ì • ë°©ë²•

- ìì› : **URI**
- í–‰ìœ„ : **HTTP method**
- í‘œí˜„ : ê²°ê³¼ë¬¼ **JSON**

<br />

> í•µì‹¬ ê·œì¹™

- 'ì •ë³´'ëŠ” URIë¡œ í‘œí˜„
- ìì›ì— ëŒ€í•œ 'í–‰ìœ„' ëŠ” HTTP methodë¡œ í‘œí˜„(GET, POST, PUT, DELETE)
- ì„¤ê³„ ë°©ë²•ë¡ ì„ ì§€í‚¤ì§€ ì•Šë”ë¼ë„ ë™ì‘ ì—¬ë¶€ì— í° ì˜í–¥ì„ ë¯¸ì¹˜ì§€ ì•Šì§€ë§Œ, ì–»ëŠ” ê²ƒì´ ë” ë§ìŒ

<br />

### JSON

- JavaScript Object Notation
- lightweight data-interchange format
- JavaScriptì˜ í‘œê¸°ë²•ì„ ë”°ë¥¸ **ë‹¨ìˆœ ë¬¸ìì—´**

<br />

> íŠ¹ì§•

- ì‚¬ëŒì´ ì½ê±°ë‚˜ ì“°ê¸° ì‰¬ì›€
- ê¸°ê³„ê°€ íŒŒì‹±(í•´ì„, ë¶„ì„)í•˜ê³  ë§Œë“¤ì–´ë‚´ê¸° ì‰¬ì›€
- C ê³„ì—´ì˜ ì–¸ì–´ê°€ ê°€ì§€ëŠ” key-value í˜•íƒœì˜ ìë£Œêµ¬ì¡°ë¡œ ë³€í™”í•˜ê¸° ì‰¬ì›€

<br />

### RESTful API

- REST ì›ë¦¬ë¥¼ ë”°ë¼ ì„¤ê³„í•œ API
- (simply) RESTful servicesë¼ê³ ë„ ë¶€ë¦„
- í”„ë¡œê·¸ë˜ë°ì„ í†µí•´ í´ë¼ì´ì–¸íŠ¸ì˜ ìš”ì²­ì— ë”°ë¼ JSONì„ ì‘ë‹µí•˜ëŠ” ì„œë²„ êµ¬ì„±

<br />

## Response

> ì½”ë“œë¥¼ í†µí•´ ì•Œì•„ë³´ì.

<br />

### ì´ˆê¸° ì„¤ì •

```python
# my_api/urls.py
from django.contrib import admin
from django.urls import path, include

urlpatterns = [
    path('admin/', admin.site.urls),
    path('api/v1/', include('articles.urls')),
]
```

```python
# articles/urls.py
from django.urls import path
from . import views

urlpatterns = [
    path('html/', views.article_html),
    path('json-1/', views.article_json_1),
    path('json-2/', views.article_json_2),
    path('json-3/', views.article_json_3),
]
```

<br />

```python
# articles/models.py
from django.db import models

# Create your models here.
class Article(models.Model):
    title = models.CharField(max_length=100)
    content = models.TextField()
    created_at = models.DateTimeField(auto_now_add=True)
    updated_at = models.DateTimeField(auto_now=True)
```

<br />

### ì‘ë‹µ ì½”ë“œ

#### HTML ì‘ë‹µ

```python
def article_html(request):
    articles = Article.objects.all()
    context = {
        'articles': articles,
    }
    return render(request, 'articles/article.html', context)
```

<br />

#### JSON ì‘ë‹µ A : forë¬¸ ì´ìš©

```python
def article_json_1(request):
    articles = Article.objects.all()
    articles_json = []

    for article in articles:
        articles_json.append(
            {
                'id': article.pk,
                'title': article.title,
                'content': article.content,
                'created_at': article.created_at,
                'updated_at': article.updated_at,
            }
        )
    return JsonResponse(articles_json, safe=False)
```

`![image](https://user-images.githubusercontent.com/86189596/164128254-a024ef34-f201-4a1b-b31f-939df7118e0e.png)`

<br />

#### Content Type entity header

- ë°ì´í„°ì˜ media type(MIME type, content type)ì„ ë‚˜íƒ€ë‚´ê¸° ìœ„í•´ ì‚¬ìš©
- ì‘ë‹µ ë‚´ì— ìˆëŠ” ì»¨í…ì¸ ì˜ ìœ í˜•ì´ ì‹¤ì œë¡œ ë¬´ì—‡ì¸ì§€ í´ë¼ì´ì–¸íŠ¸ì—ê²Œ ì „ë‹¬

<br />

#### JSON ì‘ë‹µ B : Serialization ì´ìš©

```python
def article_json_2(request):
    articles = Article.objects.all()
    data = serializers.serialize('json', articles)
    return HttpResponse(data, content_type='application/json')
```

<br />

#### JsonResponse objects

- JSON-encoded responseë¥¼ ë§Œë“œëŠ” HttpResponseì˜ ì„œë¸Œ í´ë˜ìŠ¤

<br />

> "safe" parameter

- ê¸°ë³¸ê°’ì€ True
- dict ì´ì™¸ì˜ ê°ì²´ë¥¼ ì§ë ¬í™”(Serializaton)í•˜ë ¤ë©´ Falseë¡œ ì„¤ì •í•´ì•¼ í•¨

```python
# ë”•ì…”ë„ˆë¦¬ì´ë¯€ë¡œ safe ì˜µì…˜ default(True)
response = JsonResponse({'foo':'bar'})

# ë”•ì…”ë„ˆë¦¬ í˜•íƒœê°€ ì•„ë‹ˆë¯€ë¡œ safe ì˜µì…˜ False
response = JsonResponse([1, 2, 3], safe=False)
```

<br />

### Serialization

- ì§ë ¬í™”
- ë°ì´í„° êµ¬ì¡°ë‚˜ ê°ì²´ ìƒíƒœë¥¼ ë™ì¼í•˜ê±°ë‚˜ ë‹¤ë¥¸ ì»´í“¨í„° í™˜ê²½ì— ì €ì¥í•˜ê³ , ë‚˜ì¤‘ì— ì¬êµ¬ì„±í•  ìˆ˜ ìˆëŠ” í¬ë§·ìœ¼ë¡œ ë³€í™˜í•˜ëŠ” ê³¼ì •

<br />

> ì¥ê³ ì—ì„œì˜ ì§ë ¬í™”?

- QuerySet ë° Model Instanceì™€ ê°™ì€ ë³µì¡í•œ ë°ì´í„°ë¥¼ JSONì´ë‚˜ XML ë“±ì˜ ìœ í˜•ìœ¼ë¡œ ë°”ë¡œ ë³€í™˜í•  ìˆ˜ ì—†ê¸° ë•Œë¬¸ì— **Python ë°ì´í„° íƒ€ì…ìœ¼ë¡œ ë°”ë€ ë’¤ ë³€í™˜í•˜ëŠ” ê²ƒ**

- ì¦‰, ì¤‘ê°„ ê³¼ì •!!

<br />

> ì•„ê¹Œ JSON ë°˜í™˜ ì§ë ¬í™” ì½”ë“œë¥¼ ë‹¤ì‹œ ë³´ì

```python
def article_json_2(request):
    # articlesëŠ” ì¿¼ë¦¬ì…‹ â†’ ë°”ë¡œ jsonìœ¼ë¡œ ë°”ê¿€ ìˆ˜ ì—†ë‹¤.
    articles = Article.objects.all()

    # ì§ë ¬í™”ëœ ê°ì²´
    data = serializers.serialize('json', articles)
    return HttpResponse(data, content_type='application/json')
```

- Djangoì˜ ë‚´ì¥ HttpResponseë¥¼ í™œìš©í•œ JSON ì‘ë‹µ ê°ì²´
- ì£¼ì–´ì§„ ëª¨ë¸ ì •ë³´ë¥¼ í™œìš©í•˜ê¸° ë•Œë¬¸ì— ì´ì „ê³¼ ë‹¬ë¦¬ í•„ë“œë¥¼ ê°œë³„ì ìœ¼ë¡œ ì§ì ‘ ë§Œë“¤ì–´ì¤„ í•„ìš”ê°€ ì—†ìŒ

<br />

`![image](https://user-images.githubusercontent.com/86189596/164128455-f653bded-591b-45d4-af1a-3f3a6da917e5.png)`

Aì™€ ë‹¬ë¦¬ ë‚´ì¥ëœ ëª¨ë¸ì„ ì‚¬ìš©í•˜ë¯€ë¡œ pkê°€ í‘œì‹œë˜ëŠ” ë“± ì¼ë¶€ê°€ ë‹¤ë¥´ì§€ë§Œ JSON í˜•íƒœë¡œ renderingë˜ëŠ” ê²ƒì„ ë³¼ ìˆ˜ ìˆë‹¤.

<br />

### DRF

- Django REST framework(DRF)
- Web API êµ¬ì¶•ì„ ìœ„í•œ ê°•ë ¥í•œ Toolkitì„ ì œê³µí•˜ëŠ” ë¼ì´ë¸ŒëŸ¬ë¦¬
- DRFì˜ SerializerëŠ” Djangoì˜ Form ë° ModelForm í´ë˜ìŠ¤ì™€ ë§¤ìš° ìœ ì‚¬í•˜ê²Œ êµ¬ì„± ë° ì‘ë™
- JSONì´ ì£¼ëœ ì‘ë‹µ

<br />

|        | Django |   DRF  |
|:------:|:------:|:------:|
|Response|  HTML  |  JSON  |
|Model|ModelForm|Serializer|

<br />

#### JSON ì‘ë‹µ C : DRF ì´ìš©

```python
# articles/views.py
from .serializers import ArticleSerializer

# @api_view(['GET'])
@api_view()
def article_json_3(request):
    articles = Article.objects.all()
    serializer = ArticleSerializer(articles, many=True)
    return Response(serializer.data)
```

- manyëŠ” ë‹¨ì¼ ê°ì²´ê°€ ì•„ë‹ ë•Œ Trueë¡œ ëª…ì‹œí•˜ì—¬ ì‚¬ìš©
- defaultëŠ” False

<br />

#### ArticleSerializer ì •ì˜

> ì–´? ArticleSerializerëŠ” ì •ì˜í•œ ì ì´ ì—†ëŠ”ë°ìš”?

```python
# articles/serializers.py
from rest_framework import serializers
from .models import Article


class ArticleSerializer(serializers.ModelSerializer):

    class Meta:
        model = Article
        fields = '__all__'
```

- ArticleSerializer : Article ëª¨ë¸ì˜ ì¿¼ë¦¬ì…‹ì„ JSON í˜•íƒœë¡œ ë³€í™˜í•˜ëŠ” ë°ì— ë„ì›€ì„ ì£¼ëŠ” ë„êµ¬
- ModelFormì˜ êµ¬ì¡°ì™€ ê°™ë‹¤.

<br />

#### ê²°ê³¼

`![image](https://user-images.githubusercontent.com/86189596/164129236-a506dad3-b6b5-472d-b5e3-23050aacd8b3.png)`

JSON í˜•íƒœê°€ ì•„ë‹Œ ë””ìì¸ëœ ì›¹ì‚¬ì´íŠ¸ê°€ ë‚˜ì™”ë‹¤.

<br />

`![image](https://user-images.githubusercontent.com/86189596/164129325-9229f46d-f624-4910-9501-0736f8c8e389.png)`

- ë¸Œë¼ìš°ì €ì—ì„œ ì¶œë ¥í•  ë•Œì—ëŠ” HTMLë¬¸ì„œë¡œ ì‘ë‹µì„ ë°›ìŒ
- APIë¡œì¨ ì‚¬ìš©í•˜ë ¤ í•  ë•Œì—ëŠ” JSONìœ¼ë¡œ ì‚¬ìš© ê°€ëŠ¥

<br />

> requests ë¼ì´ë¸ŒëŸ¬ë¦¬ë¥¼ ì´ìš©í•´ DRF URLë¡œ ìš”ì²­ì„ ë³´ë‚´ë³´ì

```python
import requests
from pprint import pprint

response = requests.get('http://127.0.0.1:8000/api/v1/json-3/')
pprint(response)
pprint(response.json())

# [ì‘ë‹µ]
# <Response [200]>
# ì´í›„ json ë¬¸ì„œ ì¤„ì¤„ì¤„
```

<br />

## Single Model

### DRF with Single Model

- ë‹¨ì¼ ëª¨ë¸ì˜ dataë¥¼ ì§ë ¬í™”(serialization)í•˜ì—¬ JSONìœ¼ë¡œ ë³€í™˜í•˜ëŠ” ë°©ë²•ì— ëŒ€í•œ í•™ìŠµ
- ë‹¨ì¼ ëª¨ë¸ì„ ë‘ê³  CRUD ë¡œì§ì„ ìˆ˜í–‰ ê°€ëŠ¥í•˜ë„ë¡ ì„¤ê³„
- API ê°œë°œì„ ìœ„í•œ í•µì‹¬ ê¸°ëŠ¥ì„ ì œê³µí•˜ëŠ” ë„êµ¬ í™œìš©

<br />

### ModelSerializer

- ëª¨ë¸ í•„ë“œì— í•´ë‹¹í•˜ëŠ” í•„ë“œê°€ ìˆëŠ” Serializer í´ë˜ìŠ¤ë¥¼ ìë™ìœ¼ë¡œ ë§Œë“¤ ìˆ˜ ìˆëŠ” Shortcut
- ì•„ë˜ í•µì‹¬ ê¸°ëŠ¥ ì œê³µ
  1. ëª¨ë¸ ì •ë³´ì— ë§ì¶° ìë™ìœ¼ë¡œ í•„ë“œ ìƒì„±
  2. serializerì— ëŒ€í•œ ìœ íš¨ì„± ê²€ì‚¬ê¸°ë¥¼ ìë™ìœ¼ë¡œ ìƒì„±
  3. .create() & .update()ì˜ ê°„ë‹¨í•œ ê¸°ë³¸ êµ¬í˜„ í¬í•¨

<br />

> ë‹¨ì¼ ê°ì²´ê°€ ì•„ë‹Œ ì—¬ëŸ¬ queryset ê²°ê³¼ë¥¼ serializingí•˜ëŠ” ModelSeiralizerë¥¼ ë§Œë“¤ì–´ë³´ì

```python
# articles/serializers.py
from rest_framework import serializers
from .models import Article

class ArticleListSerializer(serializers.ModelSerializer):
    
    class Meta:
        model = Article
        fields = ('id', 'title',)
```

<br />

#### ModelSerializer ì‚¬ìš©

> ipythonê³¼ shell_plusë¥¼ ì´ìš©í•´ ModelSerializerë¥¼ ì¶”ê°€í•´ë³´ì

```bash
# ModelSerializer import 
In [1]: from articles.serializers import ArticleListSerializer

# ë‹¨ì¼ ê°ì²´ ìƒì„± ë° í™•ì¸
In [3]: serializer = ArticleListSerializer()

In [4]: serializer
Out[4]: 
ArticleListSerializer():
    id = IntegerField(label='ID', read_only=True)
    title = CharField(max_length=100)
    content = CharField(style={'base_template': 'textarea.html'})
    created_at = DateTimeField(read_only=True)
    updated_at = DateTimeField(read_only=True)

In [5]: article = Article.objects.get(pk=1)

In [6]: article
Out[6]: <Article: Article object (1)>

In [7]: serializer = ArticleListSerializer(article)

In [8]: serializer
Out[8]: 
ArticleListSerializer(<Article: Article object (1)>):
    id = IntegerField(label='ID', read_only=True)
    title = CharField(max_length=100)
    content = CharField(style={'base_template': 'textarea.html'})
    created_at = DateTimeField(read_only=True)
    updated_at = DateTimeField(read_only=True)

# JSON í˜•íƒœë¡œ ë³€í™˜ëœ ë°ì´í„°ë¥¼ serializer ê°ì²´ê°€ ê°€ì§
In [9]: serializer.data
Out[9]: {'id': 1, 'title': 'Without different those candidate.', 'content': 'Speak painting matter family direction always like. Yard threat sometimes how.', 'created_at': '1981-02-22T16:42:43Z', 'updated_at': '1973-03-08T03:07:57Z'}


# ë‹¤ì¤‘ ê°ì²´ ì¿¼ë¦¬ì…‹ ìƒì„± ë° ì €ì¥
In [10]: articles = Article.objects.all()

# serialization 1 : ì¿¼ë¦¬ì…‹ë§Œ
In [11]: serializer = ArticleListSerializer(articles)

# ì˜¤ë¥˜ ë°œìƒ
In [12]: serializer.data

AttributeError: Got AttributeError when attempting to get a value for field `title` on serializer `ArticleListSerializer`.

# serialization 2 : ì¿¼ë¦¬ì…‹ê³¼ many=True ì˜µì…˜
In [13]: serializer = ArticleListSerializer(articles, many=True)

In [14]: serializer.data
Out[14]: [OrderedDict([('id', 1), ('title', 'Without different those candidate.'), ('content', 
'Speak painting matter family direction always like. Yard threat sometimes how.'), ('created_at', '1981-02-22T16:42:43Z'), ...]
```

<br />

### many argument

> many=True

- Serializing multiple objects
- ë‹¨ì¼ ì¸ìŠ¤í„´ìŠ¤ ëŒ€ì‹  QuerySet ë“±ì„ ì§ë ¬í™”í•˜ê¸° ìœ„í•´ì„œ serializerë¥¼ ì¸ìŠ¤í„´ìŠ¤í™”í•  ë•Œ many=Trueë¥¼ í‚¤ì›Œë“œ ì¸ìë¡œ ì „ë‹¬

<br />

### ê°€. GET - Article List

> urls

```python
# articles/urls.py
from django.urls import path
from . import views


urlpatterns = [
    path('articles/', views.article_list),
]
```

<br />

> views

```python
# articles/views.py
from django.shortcuts import render
from rest_framework.response import Response
from articles import serializers
from .serializers import ArticleListSerializer
from .models import Article

# Create your views here.
def article_list(request):
    articles = Article.objects.all()

    # articles querysetì„ ì§ë ¬í™”
    serializer = ArticleListSerializer(articles, many=True)
    return Response(serializer.data)
```

<br />

### api_view decorator

- ê¸°ë³¸ì ìœ¼ë¡œ GET methodë§Œ í—ˆìš©
- ë‹¤ë¥¸ methodì— ëŒ€í•´ì„œëŠ” **405 Method Not Allowed**ë¡œ ì‘ë‹µ
- View í•¨ìˆ˜ê°€ ì‘ë‹µí•´ì•¼ í•˜ëŠ” HTTP method ëª©ë¡ì„ ë¦¬ìŠ¤íŠ¸ì˜ ì¸ìë¡œ ë°›ìŒ

- â­ DRFì—ì„œëŠ” api_view decoratorë¥¼ ì„ íƒì´ ì•„ë‹Œ **ë°˜ë“œì‹œ ì‘ì„±**
- ì‘ì„±í•˜ì§€ ì•Šìœ¼ë©´ view í•¨ìˆ˜ê°€ ì‘ë™í•˜ì§€ ì•ŠëŠ”ë‹¤.

<br />

### detailì„ ìœ„í•œ serializer ì¶”ê°€ ì •ì˜

> ê¸°ì¡´ serializers.py

```python
# articles/serializers.py
from rest_framework import serializers
from .models import Article

class ArticleListSerializer(serializers.ModelSerializer):
    
    class Meta:
        model = Article
        fields = ('id', 'title',)
```

- Article querysetì— ëŒ€í•´ ì§ë ¬í™”í•˜ëŠ” serializer
- ëª¨ë“  articlesë¥¼ ë‚˜ì—´í•˜ëŠ” indexì— ì‚¬ìš©í•˜ë¯€ë¡œ, ìì„¸í•œ ì •ë³´ëŠ” ë¶ˆí•„ìš”
- fieldë¥¼ ê¸°ì¡´ '\_\_all\_\_'ì—ì„œ idì™€ titleë§Œ ë‚˜ì˜¤ë„ë¡ ë³€ê²½

<br />

> Detail serializer ì¶”ê°€ ì •ì˜

```python
class ArticleSerializer(serializers.ModelSerializer):
    
    class Meta:
        model = Article
        fields = '__all__'
```

- ìƒˆë¡­ê²Œ ì •ì˜í•´ì¤€ë‹¤.

<br />

> detail url

```python
from django.urls import path
from . import views


urlpatterns = [
    path('articles/', views.article_list),
]
```

<br />

> detail view í•¨ìˆ˜

```python
# articles/views.py

from django.shortcuts import render, get_object_or_404
from .serializers import ArticleListSerializer, ArticleSerializer

@api_view(['GET'])
def article_detail(request, article_pk):
    article = get_object_or_404(Article, pk=article_pk)
    serializer = ArticleSerializer(article)
    return Response(serializer.data)
```

<br />

### ë‚˜. POST - Create Article

- 201 Created ìƒíƒœ ì½”ë“œ ë° ë©”ì‹œì§€ ì‘ë‹µ
- RESTful êµ¬ì¡°ì— ë§ê²Œ ì‘ì„±
- article_list í•¨ìˆ˜ë¡œ ê²Œì‹œê¸€ ì¡°íšŒ, ìƒì„± ëª¨ë‘ ì²˜ë¦¬

<br />

elseë¡œ í•˜ëŠ” ê²ƒì´ ì•„ë‹ˆë¼ 
methodë§ˆë‹¤ êµ¬ì¡°ë¥¼ elifë¡œ ë‚˜ëˆ„ì–´
ì •í™•íˆ ê°€ì‹œì ìœ¼ë¡œ ë³´ì¼ ìˆ˜ ìˆë„ë¡ í•œë‹¤.

<br />

```python
# articles/views.py
from rest_framework import status

@api_view(['GET', 'POST'])
def article_list(request):
    if request.method=='GET':
        articles = get_list_or_404(Article)
        
        # articles querysetì„ ì§ë ¬í™”
        serializer = ArticleListSerializer(articles, many=True)
        return Response(serializer.data)
    
    elif request.method=='POST':
        serializer = ArticleSerializer(data=request.data) # â­request.POSTê°€ ì•„ë‹˜ì— ì£¼ì˜
        if serializer.is_valid():
            serializer.save()
            return Response(serializer.data, status=status.HTTP_201_CREATED)
        return Response(serializer.errors, status=status.HTTP_400_BAD_REQUEST)
```

<br />

> status ì˜µì…˜

- DRFì—ëŠ” status codeë¥¼ ë³´ë‹¤ ëª…í™•í•˜ê³  ì½ê¸° ì‰½ê²Œ ë§Œë“œëŠ” ë° ì‚¬ìš©í•  ìˆ˜ ìˆëŠ” ì •ì˜ëœ ìƒìˆ˜ ì§‘í•© ì œê³µ
- status ëª¨ë“ˆì— HTTP status code ì§‘í•©ì´ ëª¨ë‘ í¬í•¨
- ë‹¨ìˆœíˆ status=201 ì²˜ëŸ¼ í‘œí˜„ë„ ê°€ëŠ¥í•˜ì§€ë§Œ DRFì—ì„œëŠ” ê¶Œì¥í•˜ì§€ ì•ŠìŒ

<br />

### raise_exception

- 400 status codeë¥¼ ì‘ë‹µí•˜ëŠ” return êµ¬ë¬¸ ì‚­ì œìš©
- is_valid()ì—ì„œ ìœ íš¨ì„± ê²€ì‚¬ ì˜¤ë¥˜ ì‹œ 400_BAD_REQUESTë¥¼ ë°œìƒ

```python
@api_view(['GET', 'POST'])
def article_list(request):
    if request.method=='GET':
        articles = get_list_or_404(Article)
        
        # articles querysetì„ ì§ë ¬í™”
        serializer = ArticleListSerializer(articles, many=True)
        return Response(serializer.data)
    
    elif request.method=='POST':
        serializer = ArticleSerializer(data=request.data) 
        if serializer.is_valid(raise_exception=True): # â­is_validì˜ ì¸ìë¡œ ë“¤ì–´ê°
            serializer.save()
            return Response(serializer.data, status=status.HTTP_201_CREATED)
        # return Response(serializer.errors, status=status.HTTP_400_BAD_REQUEST) ìƒëµ ê°€ëŠ¥
```

<br />

### ë‹¤. DELETE - Delete Article

- **204 No Content** ìƒíƒœ ì½”ë“œ ë° ë©”ì‹œì§€ ì‘ë‹µ
- article_detail í•¨ìˆ˜ë¡œ ìƒì„¸ ê²Œì‹œê¸€ ì¡°íšŒ ë° ì‚­ì œ í–‰ìœ„ ëª¨ë‘ ì²˜ë¦¬ ê°€ëŠ¥

<br />

> ê¸°ì¡´ ì½”ë“œ

```python
# articles/views.py

@api_view(['GET'])
def article_detail(request, article_pk):
    if request.method=='GET':
        article = get_object_or_404(Article, pk=article_pk)
        serializer = ArticleSerializer(article)
        return Response(serializer.data)
```

<br />

> DELETE ì¶”ê°€

```python
# articles/views.py
@api_view(['GET', 'DELETE'])
def article_detail(request, article_pk):
    # â­ articleì€ ê³µìœ í•˜ë¯€ë¡œ method íŒë‹¨ ì „ì— ì €ì¥
    article = get_object_or_404(Article, pk=article_pk) 

    if request.method=='GET':
        serializer = ArticleSerializer(article)
        return Response(serializer.data)
    
    elif request.method=='DELETE':
        article.delete()
        data = {
            'delete' : f'ë°ì´í„° {article_pk}ë²ˆì´ ì‚­ì œë˜ì—ˆìŠµë‹ˆë‹¤.'
        }
        return Response(data, status=status.HTTP_204_NO_CONTENT)
```

- ì‚­ì œë˜ëŠ” ê²ƒì€ ê°ì²´ê°€ ë‚¨ëŠ” ì‘ì—…ì´ ì•„ë‹ˆë‹¤.
- ê·¸ë˜ì„œ ì‚­ì œ ì•ˆë‚´ ë©”ì‹œì§€ë¥¼ delete keyë¡œ dataì— ë‹´ì•„ Responseì— ì „ë‹¬
- **204_NO_CONTENT** ìƒíƒœ ì½”ë“œ ì‘ë‹µ

<br />

### ë¼. PUT - Update Article

- article_detail í•¨ìˆ˜ë¡œ ìƒì„¸ ê²Œì‹œê¸€ ì¡°íšŒ ë° ì‚­ì œ, ìˆ˜ì • ëª¨ë‘ ì²˜ë¦¬ ê°€ëŠ¥

```python
# articles/views.py
@api_view(['GET', 'DELETE', 'PUT'])
def article_detail(request, article_pk):
    article = get_object_or_404(Article, pk=article_pk)
    
    ...

    elif request.method=='PUT':
        serializer = ArticleSerializer(article, data=request.data)
        # serializer = ArticleSerializer(instance=article, data=request.data)
        if serializer.is_valid(raise_exception=True):
            serializer.save()
            return Response(serializer.data)
```

<br />

## 1:N Relation

### DRF with 1:N Relation

- 1:N ê´€ê³„ì—ì„œì˜ ëª¨ë¸ dataë¥¼ ì§ë ¬í™”í•˜ì—¬, JSONìœ¼ë¡œ ë³€í™˜
- 2ê°œ ì´ìƒì˜ 1:N ê´€ê³„ë¥¼ ë§ºëŠ” ëª¨ë¸ì„ ë‘ê³  CRUD ë¡œì§ì„ ìˆ˜í–‰ ê°€ëŠ¥í•˜ë„ë¡ ì„¤ê³„

<br />

### ê°€-1. ë‹¨ì¼ ëŒ“ê¸€

> Comment model ì¶”ê°€

```python
# articles/models.py
...
class Comment(models.Model):
    article = models.ForeignKey(Article, on_delete=models.CASCADE)
    content = models.TextField()
    created_at = models.DateTimeField(auto_now_add=True)
    updated_at = models.DateTimeField(auto_now=True)
```

<br />

> Commentì— ëŒ€í•œ serializers ì¶”ê°€

```python
# articles/serializers.py
from .models import Article, Comment

...

class CommentSerializer(serializers.ModelSerializer):
    
    class Meta:
        model = Comment
        fields = '__all__'
```

<br />

> url

```python
# articles/urls.py
urlpatterns = [
  ...
    path('comments/', views.comment_list),
]
```

<br />

> view

```python
# articles/views.py
from .models import Article, Comment

@api_view(['GET'])
def comment_list(request):
    comments = get_list_or_404(Comment,)
    serializer = CommentSerializer(comments, many=True)
    return Response(serializer.data)
```

<br />

### ê°€-2. ëŒ“ê¸€ detail

> url

```python
urlpatterns = [
    ...
    path('comments/<int:comment_pk>/', views.comment_detail),
]
```

<br />

> view

```python
@api_view(['GET'])
def comment_detail(request, comment_pk):
    comment = get_object_or_404(Comment, pk=comment_pk)
    serializer = CommentSerializer(comment)
    return Response(serializer.data)
```

<br />

### ë‚˜. POST - Create Comment

> url

```python
urlpatterns = [
    ...
    path('articles/<int:article_pk>/', views.article_detail),
    path('articles/<int:article_pk>/comments/', views.comment_create), â­
    path('comments/', views.comment_list),
    ...
]
```

<br />

> view

```python
@api_view(['POST'])
def comment_create(request, article_pk):
    article = get_object_or_404(Article, pk=article_pk)
    serializer = CommentSerializer(data=request.data)
    if serializer.is_valid(raise_exception=True):
        serializer.save()
        return Response(serializer.data, status=status.HTTP_201_CREATED)
```

> IntegrityError ì˜¤ë¥˜ ë°œìƒ

- Article ìƒì„±ê³¼ ë‹¬ë¦¬ Commentì˜ ìƒì„±ì€ ìƒì„± ì‹œì— ì°¸ì¡°í•˜ëŠ” ëª¨ë¸ì˜ ê°ì²´ ì •ë³´ê°€ í•„ìš”
- 1:N ê´€ê³„ì—ì„œ Nì€ ì–´ë–¤ 1ì„ ì°¸ì¡°í•˜ëŠ”ì§€ì— ëŒ€í•œ ì •ë³´ê°€ í•„ìš”í•˜ê¸° ë•Œë¬¸(ì™¸ë˜ í‚¤)

<br />

> ìˆ˜ì • ì½”ë“œ

- .save() methodëŠ” íŠ¹ì • Serializer ì¸ìŠ¤í„´ìŠ¤ë¥¼ ì €ì¥í•˜ëŠ” ê³¼ì •ì—ì„œ ì¶”ê°€ì ì¸ ë°ì´í„°ë¥¼ ë°›ì„ ìˆ˜ ìˆìŒ
- ì¸ìŠ¤í„´ìŠ¤ë¥¼ ì €ì¥í•˜ëŠ” ì‹œì ì—ì„œ ì¶”ê°€ ë°ì´í„° ì‚½ì…ì´ í•„ìš”í•œ ê²½ìš°

```python
# articles/views.py
@api_view(['POST'])
def comment_create(request, article_pk):
    article = get_object_or_404(Article, pk=article_pk)
    serializer = CommentSerializer(data=request.data)
    if serializer.is_valid(raise_exception=True):
        serializer.save(article=article) ğŸ”…
        return Response(serializer.data, status=status.HTTP_201_CREATED)
```

<br />

> require ì—ëŸ¬ ë°œìƒ

article í•„ë“œì— ëŒ€í•´ ì´ í•„ë“œëŠ” í•„ìˆ˜ í•­ëª©ì´ë¼ëŠ” ì‘ë‹µ ìˆ˜ì‹ 

<br />

#### Read Only Field(ì½ê¸° ì „ìš© í•„ë“œ)

- ì–´ë–¤ ê²Œì‹œê¸€ì— ì‘ì„±í•˜ëŠ” ëŒ“ê¸€ì¸ì§€ì— ëŒ€í•œ ì •ë³´ë¥¼ form-dataë¡œ ë„˜ê²¨ì£¼ì§€ ì•Šì•˜ê¸° ë•Œë¬¸ì— ì§ë ¬í™”í•˜ëŠ” ê³¼ì •ì—ì„œ article í•„ë“œê°€ ìœ íš¨ì„± ê²€ì‚¬(is_valid)ë¥¼ í†µê³¼í•˜ì§€ ëª»í•¨
- CommentSerializerì—ì„œ article fieldì— í•´ë‹¹í•˜ëŠ” ë°ì´í„° ë˜í•œ ìš”ì²­ìœ¼ë¡œë¶€í„° ë°›ì•„ì„œ ì§ë ¬í™”í•˜ëŠ” ê²ƒìœ¼ë¡œ ì„¤ì •ë˜ì—ˆê¸° ë•Œë¬¸

- ì´ë•ŒëŠ” **ì½ê¸° ì „ìš© í•„ë“œ(read_only_fields)** ì„¤ì •ì„ í†µí•´ **ì§ë ¬í™”í•˜ì§€ ì•Šê³  ë°˜í™˜ ê°’ì—ë§Œ í•´ë‹¹ í•„ë“œê°€ í¬í•¨ë˜ë„ë¡ ì„¤ì •**í•  ìˆ˜ ìˆìŒ
- í•˜ì§€ë§Œ ì‘ë‹µì—ëŠ” í¬í•¨

<br />

> serializers.py

```python
# articles/serializers.py
class CommentSerializer(serializers.ModelSerializer):
    
    class Meta:
        model = Comment
        fields = '__all__'
        read_only_fields = ('article',) ğŸ”…
```

<br />

### DELETE & PUT - delete, update Comment

Article ìƒì„± ë¡œì§ê³¼ ê°™ë‹¤.

```python
@api_view(['GET', 'POST', 'PUT'])
def comment_detail(request, comment_pk):
    comment = get_object_or_404(Comment, pk=comment_pk)
    if request.method=='GET':
        serializer = CommentSerializer(comment)
        return Response(serializer.data)
    
    elif request.method=='DELETE':
        comment.delete()
        data = {
            'delete' : f'ë°ì´í„° {comment_pk}ë²ˆì´ ì‚­ì œë˜ì—ˆìŠµë‹ˆë‹¤.'
        }
        return Response(data, status=status.HTTP_204_NO_CONTENT)
    
    elif request.method=='PUT':
        serializer = CommentSerializer(comment, data=request.data)
        # serializer = CommentSerializer(instance=comment, data=request.data)
        if serializer.is_valid(raise_exception=True):
            serializer.save()
            return Response(serializer.data)
```

<br />

### 1:N Serializer ê°€. íŠ¹ì • ê²Œì‹œê¸€ì— ì‘ì„±ëœ ëŒ“ê¸€ ëª©ë¡ ì¶œë ¥

- SerializerëŠ” ê¸°ì¡´ í•„ë“œë¥¼ overrideí•˜ê±°ë‚˜ ì¶”ê°€ í•„ë“œë¥¼ êµ¬ì„±í•  ìˆ˜ ìˆìŒ
- ìš°ë¦¬ê°€ ì‘ì„±í•œ ë¡œì§ì—ì„œëŠ” í¬ê²Œ 2ê°€ì§€ í˜•íƒœë¡œ êµ¬ì„±í•  ìˆ˜ ìˆìŒ
  - PrimaryKeyRelatedField
  - Nested relationships

<br />

> 1) PrimaryKeyRelatedField

- pkë¥¼ ì‚¬ìš©í•˜ì—¬ ê´€ê³„ëœ ëŒ€ìƒì„ ë‚˜íƒ€ë‚´ëŠ” ë° ì‚¬ìš© ê°€ëŠ¥
- í•„ë“œê°€ to many relationships(N)ë¥¼ ë‚˜íƒ€ë‚´ëŠ”ë° ì‚¬ìš©ë˜ëŠ” ê²½ìš° many=True ì†ì„± í•„ìš”
- comment_set í•„ë“œ ê°’ì„ form-dataë¡œ ë°›ì§€ ì•Šìœ¼ë¯€ë¡œ read_only=True ì„¤ì • í•„ìš”

<br />

> serializers.py

```python
class ArticleSerializer(serializers.ModelSerializer):
    comment_set = serializers.PrimaryKeyRelatedField(many=True, read_only=True)
    
    class Meta:
        model = Article
        fields = '__all__'
```

- Article ì¸ìŠ¤í„´ìŠ¤ì— ìˆëŠ” comment_setì´ ì´ë¯¸ ìˆë‹¤ê³  ìƒê°
- article:commentê°€ 1:N ê´€ê³„ì´ë¯€ë¡œ many=True ì„¤ì •
- ì‚¬ìš©ìë¡œë¶€í„° form-dataë¥¼ ë°›ëŠ” ê²ƒì´ ì•„ë‹Œ, ì¡°íšŒë§Œ í•˜ëŠ” ê²ƒì´ë¯€ë¡œ read_onlyë¥¼ ì†ì„±ê°’ìœ¼ë¡œ ë„£ëŠ”ë‹¤.

<br />

- ì—­ì°¸ì¡° ì‹œ ìƒì„±ë˜ëŠ” comment_setì„ ë‹¤ë¥¸ ë§¤ë‹ˆì € ì´ë¦„ìœ¼ë¡œ override ê°€ëŠ¥
- ë‹¨, ì´ì „ serializers.pyì—ì„œì˜ í´ë˜ìŠ¤ ë³€ìˆ˜ëª…ë„ ì¼ì¹˜í•˜ë„ë¡ ìˆ˜ì •í•´ì•¼ í•¨

```python
# articles/models.py
class Comment(models.Model):
    article = models.ForeignKey(Article, on_delete=models.CASCADE, related_name='comments')
```

<br />

> 2) Nested relationships

- ëª¨ë¸ ê´€ê³„ìƒìœ¼ë¡œ ì°¸ì¡°ëœ ëŒ€ìƒì€ ì°¸ì¡°í•˜ëŠ” ëŒ€ìƒì˜ í‘œí˜„(ì‘ë‹µ)ì— í¬í•¨ë˜ê±°ë‚˜ ì¤‘ì²©(nested) ê°€ëŠ¥
- ì´ëŸ¬í•œ ì¤‘ì²©ëœ ê´€ê³„ëŠ” serializersë¥¼ í•„ë“œë¡œ ì‚¬ìš©í•˜ì—¬ í‘œí˜„ ê°€ëŠ¥
- **ë‘ í´ë˜ìŠ¤ì˜ ìƒí•˜ìœ„ì¹˜ë¥¼ ë³€ê²½í•´ì£¼ì–´ì•¼ í•¨**

```python
class CommentSerializer(serializers.ModelSerializer):
    
    class Meta:
        model = Comment
        fields = '__all__'
        read_only_fields = ('article',)

class ArticleSerializer(serializers.ModelSerializer):
    comment_set = CommentSerializer(many=True, read_only=True) ğŸ”…
    
    class Meta:
        model = Article
        fields = '__all__'
```

- comment ê°ê°ì˜ ìƒì„¸ ë‚´ìš©ì„ ëª¨ë‘ ë“¤ê³  ì˜´

<br />

### 1:N Serializer ë‚˜. íŠ¹ì • ê²Œì‹œê¸€ì— ì‘ì„±ëœ ëŒ“ê¸€ì˜ ê°œìˆ˜ êµ¬í•˜ê¸°

- comment_set ë§¤ë‹ˆì €ëŠ” ëª¨ë¸ ê´€ê³„ë¡œ ì¸í•´ ìë™ìœ¼ë¡œ êµ¬ì„±
â†’ custom fieldë¥¼ êµ¬ì„±í•˜ì§€ ì•Šì•„ë„ comment_setì´ë¼ëŠ” í•„ë“œëª…ì„ fields ì˜µì…˜ì— ì‘ì„±ë§Œ í•´ë„ ì‚¬ìš© ê°€ëŠ¥

- í•˜ì§€ë§Œ ì§€ê¸ˆì²˜ëŸ¼ **ë³„ë„ì˜ ê°’ì„ ìœ„í•œ í•„ë“œë¥¼ ì‚¬ìš©í•˜ë ¤ëŠ” ê²½ìš°, ìë™ìœ¼ë¡œ êµ¬ì„±ë˜ëŠ” ë§¤ë‹ˆì €ê°€ ì•„ë‹ˆê¸° ë•Œë¬¸ì— ì§ì ‘ í•„ë“œë¥¼ ì‘ì„±**í•´ì•¼ í•¨

<br />

```python
class ArticleSerializer(serializers.ModelSerializer):
    comment_set = CommentSerializer(many=True, read_only=True)
    comment_count = serializers.IntegerField(source='comment_set.count', read_only=True) ğŸ”…
    
    class Meta:
        model = Article
        fields = '__all__'
```

<br />

> 'source' arguments

- í•„ë“œë¥¼ ì±„ìš°ëŠ” ë° ì‚¬ìš©í•  ì†ì„±ì˜ ì´ë¦„
- ì  í‘œê¸°ë²•(dot notation)ì„ ì‚¬ìš©í•˜ì—¬ ì†ì„± íƒìƒ‰
- comment_setì´ë¼ëŠ” í•„ë“œì— .(dot)ì„ í†µí•´ ì „ì²´ ëŒ“ê¸€ì˜ ê°œìˆ˜ í™•ì¸ ê°€ëŠ¥
- .count()ëŠ” built-in Queryset API ì¤‘ í•˜ë‚˜

<br />

> ì£¼ì˜ì‚¬í•­ : read_only_fields ë¬¸ì œ

- íŠ¹ì • í•„ë“œë¥¼ override í˜¹ì€ ì¶”ê°€í•œ ê²½ìš° read_only_fields shortcutìœ¼ë¡œ ì‚¬ìš© ë¶ˆê°€ëŠ¥
- ì‚¬ìš©í•˜ê³  ì‹¶ë‹¤ë©´ **í•„ë“œì— ì†ì„±ìœ¼ë¡œ ë„£ì–´ì£¼ì–´ì•¼ í•œë‹¤!**

```python
# articles/serializers.py
class ArticleSerializer(serializers.ModelSerializer):
    # comment_set = serializers.PrimaryKeyRelatedField(many=True, read_only=True)
    comment_set = CommentSerializer(many=True, read_only=True) â“
    comment_count = serializers.IntegerField(source='comment_set.count', read_only=True) â”
    
    class Meta:
        model = Article
        fields = '__all__'
        read_only_fields = ('comment_set', 'comment_count',) â“â”
```